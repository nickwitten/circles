{% extends 'members/base.html' %}
{% load crispy_forms_tags %}

<!--------------- Nav Bar ------------------->

{% block app_tabs %}


  <ul class="sub_tags bg-blue contents-blurred">
    <li><a class='text-white sub_tabs' href="{% url 'profiles' %}">Profiles</a></li>
    <li><a class='blacklink sub_tabs' href="">Profile Info</a></li>
  </ul>

{% endblock app_tabs %}

<!------------------------------------------->

{% block content %}

  <div class="container blended">
    <div class="border-bottom text-center mb-2">
      <h6>Children Associated With: {{ profile.first_name }} {{ profile.last_name }}</h6>
    </div>
    {% for childinfo in childinfos %}
      <div class="profile-container shadow">
        <div class="row">
          <div class="col-6">
            {% for child in childinfo.order_children %}
              <div class="border-bottom m-3 pb-2">
                <h6 class="mb-1 d-inline-block">{{ child.last_name }}, {{ child.first_name }} {{ child.middle_initial }}.</h6>
                <button class="modal-trigger far fa-edit icon-btn text-small mb-2 ml-2" data-id="{% url 'update-child' child.pk %}" type="button" name="button">
                </button>
                <div class="row">
                  <div class="col-6">
                    <p class="m-0">Relationship: {{ child.relationship }}</p>
                  </div>
                  <div class="col-6">
                    <p class="m-0">Circles attendance: {{  child.attendance }}</p>
                  </div>
                </div>
                <div class="row">
                  <div class="col-6">
                    <p class="m-0">Birthdate: {{ child.birthdate }}</p>
                  </div>
                  <div class="col-6">
                    <p class="m-0">Age: {{  child.calculate_age }}</p>
                  </div>
                </div>
                <p class="m-0">Gender: {{ child.gender }}</p>
                <div class="row">
                  <div class="col-6">
                    <p class="m-0">Known health issues:</p>
                  </div>
                  <div class="col-6">
                    <p class="m-0">{{ child.health_issues }}</p>
                  </div>
                </div>
                <p class="m-0">Date of last physical exam: {{ child.physical_date }}</p>
                <div class="row">
                  <div class="col-6">
                    <p class="m-0">Allergies</p>
                  </div>
                  <div class="col-6">
                    <p class="m-0">{{ child.allergies }}</p>
                  </div>
                </div>
                <div class="row">
                  <div class="col-6">
                    <p class="m-0">Medications:</p>
                  </div>
                  <div class="col-6">
                    <p class="m-0">{{ child.medications }}</p>
                  </div>
                </div>
                <div class="row">
                  <div class="col-6">
                    <p class="m-0">Dietary modifications:</p>
                  </div>
                  <div class="col-6">
                    <p class="m-0">{{ child.dietary_modifications }}</p>
                  </div>
                </div>
                <div class="row">
                  <div class="col-6">
                    <p class="m-0">Disability, behavioral barriers, limitations::</p>
                  </div>
                  <div class="col-6">
                    <p class="m-0">{{ child.disabilities }}</p>
                  </div>
                </div>

              </div>
            {% endfor %}
            <div class="text-right">
              <div class="form-group mb-0 d-inline-block ml-3 mr-3">
                <button class="modal-trigger btn btn-sm btn-outline-secondary text-small" data-id="{% url 'create-child' childinfo.pk %}" type="button" name="button">
                  Add Child
                </button>
              </div>
            </div>
          </div>
          <div class="col-2">
          </div>
          <div class="col-4">
            <div class="m-3">
              <div class="mb-3">
                <p class="font-weight-bold mb-1">Parent/Guardian</p>
                <p class="m-0">{{ childinfo.parent_first_name }} {{ childinfo.parent_last_name }}</p>
                <p class="m-0">{{ childinfo.parent_phone }}</p>
                <p class="m-0">{{ childinfo.parent_street_address }}, {% if childinfo.parent_unit %}Unit #{{childinfo.parent_unit }}{% endif %}
                </p>
                <p class="m-0">{{ childinfo.parent_city }}, {{ childinfo.parent_state }} {{ childinfo.parent_zip }}</p>
              </div>
              <div class="mb-3">
                <p class="font-weight-bold mb-1">Emergency Contact</p>
                <p class="m-0">{{ childinfo.e_relationship }}</p>
                <p class="m-0">{{ childinfo.e_first_name }} {{ childinfo.e_last_name }}</p>
                <p class="m-0">{{ childinfo.e_phone }}</p>
              </div>
              <div class="mb-3">
                <p class="font-weight-bold mb-1">Physician</p>
                <p class="m-0">{{ childinfo.physician_name }}</p>
                <p class="m-0">{{ childinfo.physician_practice }}</p>
                <p class="m-0">{{ childinfo.physician_phone }}</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    {% endfor %}
    <div class="profile-container shadow">
      <div class="form-group m-0 pb-2 pt-2 d-inline-block">
        <button class="create-childinfo btn btn-outline-secondary" type="button" name="button">Create</button>
      </div>
      <p class="small">Create a new parent/guardian, emergency contact, and physician set to place children under.</p>
    </div>
  </div>

  <!---------------------- Modal Popup ------------------>

  <div class="modal fade" tabindex="-1" role="dialog" id="modal">
    <div class="modal-dialog" role="document">
      <div class="modal-content popup">
      </div>
    </div>
  </div>


<script type="text/javascript">
  $(document).ready(function() {

    $(".create-childinfo").modalForm({
      formURL: "{% url 'create-childinfo' profile_pk %}"
    });

    $(".modal-trigger").each( function () {
      $(this).modalForm({formURL: $(this).data('id')});
    });

  });
</script>

{% endblock content %}
